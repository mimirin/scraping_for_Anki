Abstract
Noninvasive Brain Computer Interfaces (BCI) have been promoted to be used for neuroprosthetics. However, reports on applications with electroencephalography (EEG) show a demand for a better accuracy and stability. Here we investigate whether near-infrared spectroscopy (NIRS) can be used to enhance the EEG approach. In our study both methods were applied simultaneously in a real-time Sensory Motor Rhythm (SMR)-based BCI paradigm, involving executed movements as well as motor imagery. We tested how the classification of NIRS data can complement ongoing real-time EEG classification. Our results show that simultaneous measurements of NIRS and EEG can significantly improve the classification accuracy of motor imagery in over 90% of considered subjects and increases performance by 5% on average (p < 0:01). However, the long time delay of the hemodynamic response may hinder an overall increase of bit-rates. Furthermore we find that EEG and NIRS complement each other in terms of information content and are thus a viable multimodal imaging technique, suitable for BCI.

Highlights
► We use multi-modal imaging (whole-head NIRS and EEG) for sensory motor rhythm based BCI. ► By the use of meta-classifiers we enhance performance by 5% on average. ► Some subjects, previously not able to operate a BCI, now become able to do so. ► NIRS and EEG have different information content and complement each other.

Previous article in issueNext article in issue
Keywords
Combined NIRS-EEGHybrid BCIMeta-classifier
Introduction
One of the main goals of Brain Computer Interface (BCI) related research today is to increase information transfer rates while at the same time minimizing the cost of setup. The latter being the actual setup of hardware during a session, as well as the calibration of subject-dependent classifiers for real-time feedback. Since its precursors in the early 70s (Vidal, 1973) BCI technology has developed many variants and employed a large number of methods, such as electroencephalography (EEG) (Birbaumer et al., 1999, Parra et al., 2002, Cheng et al., 2002, Buttfield et al., 2006, Blankertz et al., 2007, Dornhege et al., 2007, Wolpaw et al., 2002), Magnetoencephalography (MEG) (Waldert et al., 2008), Electrocorticography (ECoG) (Ramsey et al., 2006, Leuthardt et al., 2006, Felton et al., 2007, Pistohl et al., 2008, Miller et al., 2010, Brunner et al., 2011), functional magnetic resonance imaging (Weiskopf et al., 2003, Yoo et al., 2004, Sorger et al., 2009, Lee et al., 2009), near-infrared spectroscopy (NIRS) (Tsubone et al., 2007, Abdelnour and Huppert, 2009) among others. Combinational approaches for EEG features from multiple domains (Dornhege et al., 2004), such as movement related potentials (MRPs) and event-related desynchronizations (ERD), as well as combinations of EEG and peripheral parameters like electromyography (Leeb et al., 2010) have been shown to increase the robustness of the classification.

These positive findings for combined approaches have motivated us for an evaluation of a simultaneous EEG and NIRS setup which preserves the advantages of both non-invasive techniques namely low costs, portability and easiness to handle. NIRS measures the concentration changes of oxygenated and deoxygenated hemoglobins ([HbO] and [HbR]) in the superficial layers of the human cortex. While concentration of [HbO] is expected to increase after focal activation of the cortex due to higher blood flow, [HbR] is washed out and decreases (Kwong et al., 1992, Villringer et al., 1993, Logothetis et al., 2001). Thereby, it measures a comparable effect to the blood oxygenation level dependent (BOLD) contrast in functional magnetic resonance imaging (fMRI), since also here the washout of [HbO] is the major constituent (Kleinschmidt et al., 1996).

The idea of using NIRS as an optical BCI has been introduced by Coyle in 2004 (Coyle et al., 2004). Since then a number of groups followed the direction of using NIRS as a basis for optical BCI (Coyle et al., 2007, Sitaram et al., 2007, Wriessnegger et al., 2008, Bauernfeind et al., 2008, Kanoh et al., 2009, Luu and Chau, 2009), by either examining the resulting signals for motor imagery or classifying the NIRS signals directly. A recent publication used NIRS as a ‘brain switch’ and combined it with an EEG-based SSVEP for the operation of an orthosis (Pfurtscheller et al., 2010). However, to our knowledge our study is the first report of simultaneous EEG and NIRS measurements for SMR-based Brain–Computer-Interfacing. In general a multi modal approach can have a number of benefits: As every neuroimaging method suffers from its particular limitations (EEG from spatial resolution, while NIRS or fMRI from the sluggishness of the underlying vascular response limiting its temporal resolution), it now becomes possible to partly overcome these by focusing on their individual strengths (Friston, 2009, Bießmann et al., 2011). Furthermore and maybe more importantly, the information gained from these various sources complement each other to some degree (Bießmann et al., 2010, Murayama et al., 2010). Due to this reasoning it becomes apparent, why simultaneous NIRS and EEG measurements are widely used in order to research language processing (Wartenburger et al., 2007, Ehlis et al., 2009, Telkemeyer et al., 2009, Rossi et al., 2010, Grossmann et al., 2010) and the visual cortex (Obrig et al., 2002, Herrmann et al., 2008). A recent study that examines the somato-motoric activity following medial nerve stimulation (Takeuchi et al., 2009) shows the reliability of simultaneous measurements of NIRS and EEG in the motor and somatosensory domain, which proves to be valid for SMR-based BCI as well.

By extracting relevant NIRS features to support and complement high-speed EEG-based BCI and thus forming a hybrid BCI (Pfurtscheller et al., 2010), we exploit the responsiveness of EEG (i.e. high ITR) as well as enhance and robustify overall BCI performance by using information from the vascular response, which are not contained within the EEG. Moreover, we evaluate the time delay and spatial information content of the hemodynamic response during a SMR-based BCI paradigm.

The following section introduces the setup and design of our study, as well as the statistical tools we applied for the analysis of the acquired data. In Results section we present the experimental results and Discussion and conclusions section concludes the work by discussing our findings and puts them into perspective with future work.

Methods
Participants and experimental design
14 healthy, right-handed volunteers (aged 20 to 30) participated in the study, which lasted approximately 4 h. The experiment was approved by the local ethics committee (Charité University Medicine, Berlin, Germany), and performed in accordance with the policy of the Declaration of Helsinki. The subjects were seated in a comfortable chair with armrests and were instructed to relax their arms. The experiment consists of 2 blocks of motor execution by means of hand gripping (24 trials per block per condition) and 2 blocks of real-time EEG-based, visual feedback controlled motor imagery (50 trials per block per condition). For all blocks the first 2 s of each trial began with a black fixation cross, that appeared at the center of the screen. Then, as a visual cue an arrow appeared pointing to the left or right. For the case of motor imagery, the fixation cross started moving for 4 s, according to the classifier output. After 4 s the cross disappeared and the screen remained blank for 10.5 ± 1.5 s. The online processing was based on the concept of coadaptive calibration (Vidaurre et al., 2011) and is described in detail in Data analysis section. For the case of executed movements the fixation cross remained fixed and the subjects were instructed to open and close their hands with an approximate frequency of 1 Hz. Also here after 4 s the cross disappeared and the screen remained blank for 10.5 ± 1.5 s.

Data acquisition
During both tasks simultaneous measurements of EEG and NIRS were performed. The NIRS-System (NIRScout 8–16, NIRx Medizintechnik GmbH, Germany) was equipped with 24 optical fibers (8 sources with wavelengths of 850 nm and 760 nm, 16 detectors convolving to 24 measurement channels). Frontal, motor and parietal areas of the head were covered as shown in Fig. 1. The sampling frequency was fNIRS = 6.25 Hz. EEG, electrooculogram (EOG) and electromyogram (EMG) were recorded with a multichannel EEG amplifier (BrainAmp by Brain Products, Munich, Germany) using 37 Ag/AgCl electrodes, 2 bipolar EMG, 2 bipolar EOG (vertical as well as horizontal EOG), sampled at fEEG = 1 kHz and downsampled to 100 Hz. NIRS probes and EEG electrodes were integrated in a standard EEG cap (extended 10–20 system with a possibility of 256 electrodes) with inter-optode distances between 2 and 3 cm. The optical probes are constructed, such that they fit into the ring of standard electrodes. This enables us to situate the NIRS channel positions according to the standard 10–20 system, as can be seen in Fig. 1.


Download high-res image (187KB)Download full-size image
Fig. 1. Locations of EEG electrodes; sources, detectors and actual measurement channels of NIRS. Note that electrodes and optodes might share a location.

Data analysis
Based on a recent development coined Co-adaptive Calibration the user was given instantaneous EEG-based BCI feedback for the two blocks of motor imagery (Vidaurre et al., 2011). During the first block of 100 trials a subject-independent classifier, depending on band power estimates of laplacian filtered, motor-related EEG channels, was used. For the second block subject-dependent spatial and temporal filters were estimated from the data of the first block and combined with some subject-independent features, namely band power of laplacian filtered, motor-related EEG electrodes, to form the classifier for the second block. During the online feedback features were calculated every 40 ms with a sliding window of 750 ms.

The analysis of NIRS data was performed offline. Concentration changes of hemoglobin were calculated according to the modified Lambert–Beer law on the NIRS data (differential path length factor of 5.98 (higher wavelength: 830 nm) and 7.15 (lower wavelength: 760 nm), extinction coefficients for [HbO] 2.5264/1.4866 (higher/lower wavelength) and [HbR] 1.7986/3.8437 (higher/lower wavelength), and an inter-optode-distance of 3 cm). This procedure converts attenuation changes measured by the NIRS system into concentration changes of oxygenated [HbO] and deoxygenated [HbR] hemoglobin (Cope et al., 1988, Kocsis et al., 2006). NIRS data was low-pass filtered at 0.2 Hz using a one-directional filter method, namely a 3rd order Butterworth-filter. A baseline interval was defined from − 2 s to 0 s before stimulus onset, and its mean subtracted from each trial. To examine how well the NIRS data classifies the given tasks we analyzed the time courses with the help of a moving window (width 1 s, step size = 500 ms) that we apply from 6 s, prior to stimulus onset and up to 15 s after stimulus onset. Time courses of [HbO] and [HbR] were averaged over the time length of the moving window width, resulting in average concentration changes for each of the 24 channels. These time-averaged concentration changes were then used as features for a linear discriminant analysis (LDA). Validation was performed by a cross-validation with an 8-fold chronological split. Previous studies have shown that a chronological split maintains non-stationarities of the data and thus represents a relatively conservative measure (Lemm et al., 2011). We used the time interval of the global peak classification accuracy and performed paired t-tests to test whether classification of motor imagery shows a significantly earlier peak accuracy as compared to executed movements and in which chromophore accuracy was higher. Trials of the two measured blocks per condition were combined.

Offline EEG decoding was performed as follows: For both paradigms (real movements and motor imagery) the two blocks were combined. Subject-dependent band-pass filter coefficients were estimated by means of an established procedure (Blankertz et al., 2008). The selected band-bass filter coefficients for executed movements were mostly in the α-band (5 of 14 subjects) and in the β-band (7 of 14 subjects). For a small proportion of subjects (2 of 14) a broad-band filter was selected. For the case of motor imagery the discriminant information was highest in the α-band (10 of 14 subjects), followed by the β-band (3 of 14 subjects). Only for one subject a broad-band filter was chosen.

A spatial filter, in form of Common Spatial Patterns (Fukunaga, 1990, Koles and Soong, 1998, Ramoser et al., 2000, Blankertz et al., 2008) was estimated and a LDA classifier computed. The previously mentioned parameters for subject-dependent temporal filters, spatial filters and linear classifier were estimated solely on the training set of each cross-validation step Lemm et al. (2011). The cross-validation followed the same principle as mentioned for the NIRS signals. For the time course of classification accuracy the same moving window was applied as for the NIRS data. Furthermore to establish a single measure of classification accuracy for each subject and paradigm, the time interval was chosen to be [750 − 3500] ms after stimulus onset for all subjects.

To examine the possible benefits of combining both signal domains, classification results were calculated for EEG and NIRS separately, but also in combination by estimating a meta-classifier. After estimation of the three individual classifiers (one for the EEG induced band power changes and one each for the evoked deflection from baseline [HbO] and [HbR]) and their performance, we explore a number of possible combinations (such as EEG, [HbO] or EEG, [HbO], [HbR] etc.).

Our selection of NIRS features for the combination with EEG was based on the global peak cross-validation accuracy for each individual subject. As a meta-classifier we used an LDA, whose weights are re-estimated within each cross-validation step in order to avoid a bias in the estimation of the generalization error (Lemm et al., 2011). The general procedure can be seen in Fig. 2. To graphically investigate the potential improvement of a combination of NIRS and EEG measurements as compared to a BCI, solely dependent on EEG, we show scatter plots comparing EEG classification accuracy and the improvement for EEG in combination with each NIRS chromophore as well as both chromophores.


Download high-res image (119KB)Download full-size image
Fig. 2. Flowchart of the first step of the cross-validation procedure: The EEG and NIRS data is split into 78 training data and 18 test data. First an individual LDA classifier is computed for EEG, [HbO] and [HbR]. Then a meta-classifier is estimated for optimally combining the three LDA outputs. All LDA classifiers are then applied to the test set (dotted green line) and a test loss computed. The procedure is repeated for 8 chronological splits.

To gain topographical maps of significant features, and thereby show the physiological validity of our results, we calculated point-biserial correlation coefficients (Tate, 1954). The point-biserial correlation coefficient is a special case of the Pearson product–moment correlation coefficient and measures the association of a binary random variable and a continous random variable. It is defined as:
(1)
where M1 and M0 are the mean values of data points in groups 1 and 0, n1/0 the number of examples in groups 1 and 0 and n the total sample size. Using Fishers transformation the correlations were transformed into unit variance z-scores for each subject j (Hotelling, 1953) and grand average z-scores were obtained by a weighted sum of individual z-scores over all subjects:
(2)
where mj is the sample size of subject j and N = 14 the total number of subjects. p-values for the hypothesis of zero correlation in the grand average were computed by means of a two-sided z-test.

Mutual information is an information theoretic measure, which estimates the information that two random variables share. It can be expressed in terms of conditional entropies of random variables X and Y:
(3)

The conditional entropy H(X|Y) quantifies the remaining entropy of X, after the value of Y is known. If H(X|Y) = H(X), then I(X; Y) = 0: the variables are independent. On the other hand, if X and Y are identical, then H(X|Y) = 0and hence I(X; Y) = H(X). I(X; Y) is symmetric and its values are in the range of 0 and 1: I(X; Y) = I(Y; X) ∈ [0; 1] (MacKay, 2002). To examine the degree of independence between the NIRS and EEG-based classifier outputs, we restrict their outputs to values 0 and 1 and estimate their mutual information.

To further investigate, whether mostly the same trials are classified wrongly by EEG and by NIRS, we form two groups of trials: one group consists only of trials, where EEG classification was correct, while in the other group only misclassified trials are included. By comparing the NIRS classification of each of these groups to the mean classification of both groups, we can examine to which extent the NIRS classification results resemble those of the EEG.

Results
Physiological reliability of NIRS features
Our first aim is to show the physiological reliability of NIRS feature classification both in time and location. We performed single trial classification of left vs. right motor execution (and imagery) with a moving time window after stimulus onset. Classification accuracies for each subject over time can be seen in Fig. 3 for EEG (top row) and both chromophores of NIRS (middle: [HbO], bottom: [HbR]). The left column shows motor imagery and the right column executed movements. A classification accuracy of 100% means that the two conditions are perfectly separable, while a classification accuracy of 50% represents random guessing when considering a binary classification task.


Download high-res image (2MB)Download full-size image
Fig. 3. EEG and NIRS classification accuracy [%] (LDA) for a 1 s moving time window (top: EEG, middle: [HbO], bottom: [HbR], left: motor execution, right: motor imagery). The x-axis denotes the center of the moving window. Colored lines show the accuracy for the single subjects while the black line is the average over subjects. The gray bar indicates the time interval of cue presentation.

Average EEG classification peaks at 〈teegreal〉 = 1680 ± 1014 ms for executed movements and at 〈teegimag〉 = 1430 ± 707 ms for motor imagery. Peak classification times of [HbO] are at 〈thboreal〉 = 7430 ± 2201 ms and at 〈thboimag〉 = 6501 ± 1579 ms and of [HbR] at 〈thbrreal〉 = 6966 ± 2484 ms and 〈thbrimag〉 = 6109 ± 1339 ms for executed movements and motor imagery, respectively. EEG features are thus earlier classifiable as compared to [HbO] and [HbR] for executed movements (p < 10− 6 and p < 10− 5) and for motor imagery (p < 10− 6 and p < 10− 6).

Average EEG classification accuracy for executed movements (90.8%) is higher than that of [HbO] (71.1.%) and [HbR] (73.3%). Paired t-tests between EEG and the two NIRS chromophores yield highly significant results (p < 10− 3 and p < 0.01). While also for motor imagery EEG scores higher average classification rates (EEG: 78.2%, [HbO]: 71.7%, [HbR]: 65.0%), here not both p-values are significant (p = 0.09 and p < 0.05). For motor imagery [HbO] shows a significantly higher classification accuracy, as compared to [HbR] (p < 0.01).

To examine the topology of significant EEG and NIRS features, Fig. 4, Fig. 5 show log(p) significances of executed and motor imagery, respectively. The time-dependent scalp plots show grand-averages over all subjects, based on the point-biserial correlation coefficient rpb, as described above. The color bar scales on the right side indicate the significance levels of the individual imaging methods. Note that the width of the scale illustrates the maximum level of significance. Red colors denote higher values of the left class, while blue colors indicate higher values within the right class. As can be seen for both paradigms EEG as well as NIRS chromophores show highly significant patterns in motor-related cortical areas. Note that for EEG (top rows of Fig. 4, Fig. 5) we observe event-related desynchronization (ERD) which is followed by an event-related synchronization (ERS), a previously described physiological effect for EEG oscillations in the alpha and beta band (Pfurtscheller, 1992).


Download high-res image (1MB)Download full-size image
Fig. 4. Scalp evolution of grand-average log p values for motor execution in EEG and NIRS over all subjects (top: EEG, middle: [HbO], bottom: [HbR]). Red colors denote higher values of the left class, while blue colors indicate higher values within the right class. Note that the width of the color-scale on the right indicates the level of significance.


Download high-res image (1MB)Download full-size image
Fig. 5. Scalp evolution of grand-average log p values for motor imagery in EEG and NIRS over all subjects (top: EEG, middle: [HbO], bottom: [HbR]). Red colors denote higher values of the left class, while blue colors indicate higher values within the right class. Note that the width of the color-scale on the right indicates the level of significance.

Interestingly, we find higher significance levels of [HbR] in both paradigms, as compared to the classification results, where [HbO] yielded higher accuracies for motor imagery. A second interesting point to note is the inverted polarity of [HbO] for motor imagery. This effect can also be seen in the averaged time courses of NIRS data shown in Fig. 6. [HbO] has the expected shape of a hemodynamic response function in the motor execution task, although it ascends in both hemispheres but decreases in the imagery condition. [HbR] shows the expected time courses for both tasks (imagery/executed) and both conditions (left/right).


Download high-res image (693KB)Download full-size image
Fig. 6. Group-average time courses for the two NIRS channels (namely C3|CFC3 and C4|CFC4) with highest discriminability for both conditions (left and right) and chromophores ([HbO] and [HbR]). Executed movement timecourses are shown on the left panels, while motor imagery timecourses on the right. Top panels depict [HbO] and bottom panels [HbR]. The small gray patch before the first vertical line indicates the baseline, which was set from − 2 s to 0 s. The second, larger gray patch indicates the time period of cue presentation (0 s to 4 s).

Enhancing EEG–BCI performance by NIRS features
While the examination of the NIRS classification itself provided information about the quality and spatial specificity of the NIRS features, a second aim was to actually combine NIRS and EEG features to form a hybrid-BCI. As stated in Data analysis section a meta classifier was derived for combining the individual signals. Table 1 shows classification accuracies for EEG, [HbR] and [HbO] and their combinations for both tasks. Furthermore we show scatter plots, where the EEG performance is plotted against possible combinations (see Fig. 7). Dots above the green line indicate that a subject's performance is increased by the combination of the NIRS chromophore(s) as compared to using only EEG. The percentage within the figure indicates the percent of subjects, for whom the combination leads to equal or improved decoding, and the p-value the significance of the improvement.

Table 1. Individual LDA classification accuracies for features of both NIRS chromophores ([HbO] and [HbR]) and EEG, and their combinations with a meta-classifier. * marks significant (p < 0.05), ** highly significant (p < 0.01) improvements for the individual combinations of EEG and NIRS features versus plain EEG decoding. p-values are based on paired t-tests.

Executed movements	Motor imagery
VP	NIRS	EEG	EEG+	NIRS	EEG	EEG+
[HbO]	[HbR]		[HbO]	[HbR]	[HbO + R]	[HbO]	[HbR]		[HbO]	[HbR]	[HbO + R]
VPeaa	84.4	99.0	100.0	99.0	100.0	100.0	77.5	65.0	58.5	78.0	70.0	81.0
VPeab	64.6	75.0	85.4	87.5	89.6	85.4	61.5	50.5	98.0	98.5	98.0	98.5
VPeac	69.8	56.2	99.0	99.0	99.0	96.9	62.0	57.5	65.0	69.5	65.0	72.0
VPead	91.7	79.2	99.0	100.0	96.9	93.8	72.0	58.5	74.5	80.0	75.0	77.5
VPeae	69.8	85.4	97.9	97.9	97.9	94.8	80.0	70.0	82.0	86.5	84.0	85.0
VPeaf	59.4	52.1	94.8	93.8	93.8	82.3	57.0	59.0	58.0	57.5	57.5	57.0
VPeag	58.3	69.8	100.0	100.0	100.0	100.0	91.5	90.0	89.5	97.0	96.0	97.0
VPeah	77.1	90.6	55.2	77.1	90.6	85.4	85.0	85.0	95.5	95.5	96.0	95.0
VPeai	52.1	49.0	76.0	68.8	69.8	63.5	52.5	54.5	55.0	56.5	58.5	48.5
VPeaj	60.4	63.5	90.6	91.7	92.7	77.1	81.5	58.5	89.5	93.0	89.0	92.5
VPeak	59.4	59.4	93.8	94.8	91.7	72.9	70.0	65.5	78.0	82.5	79.0	84.5
VPeal	99.0	99.0	91.7	99.0	99.0	99.0	75.0	74.5	93.5	95.0	96.0	94.0
VPeam	65.6	60.4	89.6	89.6	86.5	75.0	76.0	57.0	58.0	75.5	64.0	80.5
VPean	84.4	87.5	97.9	97.9	97.9	97.9	62.0	64.5	100.0	100.0	100.0	100.0
Mean	71.1	73.3	90.8	92.6	93.2	87.4	71.7	65.0	78.2	83.2**	80.6*	83.1*

Download high-res image (581KB)Download full-size image
Fig. 7. Scatter plot comparing classification accuracies and significance values of various combinations of NIRS and EEG for real and motor imagery. The x-axis depicts the EEG classification accuracy. The y-axes depict the classification accuracy of the combinations: EEG + [HbO], EEG + [HbR] and EEG + [HbO] + [HbR] (from left to right).

While the results in Table 1 indicate that combinations of EEG and NIRS are beneficial for average decoding success for both paradigms, only combinations for motor imagery score (highly) significant improvements. When comparing EEG with combined EEG/[HbO] for motor imagery, there was an average 5% classification accuracy increase across all subjects. This increase is highly significant (p < 0.01) and the combination scores higher or equal classification rates for 13 out of 14 subjects. Interestingly, two subjects (VPeaa and VPeam) with very bad performance in EEG–BCI were much better classifyable when EEG/NIRS was used (with rates of 81% and 80.5%, respectively). The two other subjects with very low EEG performance, namely VPeac and VPeal, did not show further improvements.

Fig. 8 shows the relation of the classification performance of the individual measurement methods (EEG, [HbO] and [HbR]) in relation to their mutual information content (I(EEG; [HbO]) and I(EEG; [HbR]). The left column shows these results for executed movements, while the left column shows the results for the motor imagery. Generally speaking the mutual information content rises with higher classification accuracy for all considered methods. If for a given subject method X scores a low classification accuracy, one would expect the conditional entropy H(X|Y) to be of similar magnitude as H(X) and therefore the mutual information content is very low. On the other hand if both methods score very high classification accuracies, H(X|Y) will be low, leading to a high mutual information content.


Download high-res image (411KB)Download full-size image
Fig. 8. Mutual information of EEG and NIRS classifier outputs (x-axes) are compared with their respective classification performances (y-axes). Each triangle pair represents the results of a single subject (blue — [HbO]; green — [HbR]). The left column shows executed movements, the right column motor imagery. Top rows: EEG classification accuracy vs. the mutual informations of I(EEG; [HbO]) and I(EEG; [HbR]). Bottom rows: classification accuracies of [HbO] and [HbR] vs. their respective mutual information with EEG.

However, for some subjects we see that, while the classification accuracy of a given method is high, we observe a low mutual information content. This can be interpreted in two ways. Either the other classification method does not work well (and its output is thus very different) or their information content is complementary. The average mutual information over all subjects for executed movements are given as: I(EEG; [HbO]) = 0.125 ± 0.177 bit and I(EEG; [HbR]) = 0.194 ± 0.277 bit. For motor imagery I(EEG; [HbO]) = 0.096 ± 0.127 bit and I(EEG; [HbR]) = 0.067 ± 0.110 bit.

The left part of Fig. 9 shows the relation of [HbO] classification performance to [HbO] classification performance of trials that were correctly classified by EEG (HbO(EEG+)) and to [HbO] classification performance of trials that we misclassified by EEG (HbO(EEG−)). The right part shows the same analysis, comparing EEG classification accuracy to EEG(HbO+) and to EEG(HbO−). As can be seen for both plots most points lie close to the angle bisector, only a few blue marks appear below the diagonal. However, these are caused by very small subgroups (the size of the squares encode the number of trials). This means that [HbO] and EEG generally misclassify different trials. If they did not and for example HbO(EEG+) would classify more accurately as compared to HbO(EEG−), green dots would generally be substantially higher than blue ones. However, since this is not the case we conclude that the classifier outputs, coming from the two signals are independent to some degree. While we do not explicitly show the results here, results are similar for [HbR].


Download high-res image (273KB)Download full-size image
Fig. 9. Left: Scatter plot comparing [HbO] classification accuracy of all trials to [HbO] classification accuracy, whose EEG classification was correct (green dots) or incorrect (blue dots). Right: comparing EEG classification accuracy of all trials to EEG classification accuracy of trials, where [HbO] was correct/incorrect. The sizes of squares encode the number of trials.

Discussion and conclusions
Recently BCIs that solely rely on NIRS have been realized (Tsubone et al., 2007, Abdelnour and Huppert, 2009). However, when looking at plain NIRS classification rates it becomes apparent that NIRS cannot be seen as a viable alternative to EEG-based BCIs on its own. However, in a combination with EEG we find that NIRS is capable of enhancing event-related desynchronization (ERD)-based BCI performance significantly. Not only does it increase performance for most subjects, but it also allows meaningful classification rates for those who would otherwise not be able to operate a solely EEG-based BCI.

Given that the typical behavior of hemoglobin oxygenation during brain activation consists of an increase in [HbO] approximately mirrored by a decrease of [HbR] (Lindauer et al., 2001, Steinbrink et al., 2006), for motor imagery (Fig. 6) only [HbR] clearly showed the typical behavior. For [HbO] there seems to be an initial drop followed by a subsequent rise. While we have no simple explanation for this finding, following are some considerations which may be relevant: The overall amplitudes during motor imagery are much smaller than during motor movements (note the different scaling) in line with previous fMRI experiments (Hermes et al., 2011). Therefore, spontaneous fluctuations of [HbO] and [HbR] may appear much more dominant to the point that they can obscure some small simulation-related changes. Since spontaneous fluctuations are much stronger for [HbO] than for [HbR] this may be part of the observed discrepancy. Furthermore, in NIRS with its poorer spatial resolution as compared to fMRI activated and non-activated or deactivated brain areas may be within the sample volume and such partial volume effects may further “dilute” the effect of stimulation. Given that during motor imagery premotor cortex may be activated and primary motor cortex not (Hermes et al., 2011) which is different from motor movements, it seems possible that such partial volume effects have occurred during motor imagery. Finally, as seen in Fig. 6, [HbO] is rapidly changing during the “baseline” period, i.e. the average of this time period may not serve as an optimal definition of baseline for [HbO] making the quantitative interpretations referring to this baseline difficult. A last consideration refers to potential extracerebral contributions which are stronger for the HbO signal than the HbR signal and which may be related to such systemic factors as e.g. blood pressure. Further research is needed to clarify this point. We are currently preparing a similar study with EEG-feedback controlled SMR–BCI during simultaneous fMRI recordings. Therewith, we will be able to relate BOLD fMRI findings to the EEG and (indirectly) the NIRS recordings. Furthermore, we hope that a simultaneous NIRS–fMRI study with measures of systemic variables such as blood pressure and breathing will give us further evidence of the origin of this effect.

An obvious concern that arises from the addition of NIRS to EEG-based BCI feedback is the long time delay of the hemodynamic response. While we show that classification accuracy increases substantially by employing NIRS, one may rightly argue that information transfer rates, which measure information per unit time, could suffer from the inferior temporal responsiveness of such a combination. To this end we would like to offer the following arguments. Firstly, for subjects (and patients) which are not able to operate a BCI, solely based on EEG, this combination presents a viable alternative. Secondly, one could imagine a feedback scenario, where a secondary NIRS-derived classifier is only turned on in particular trials, when the ‘primary’ EEG-based classification is likely to fail.

In terms of information content, we show that the mutual information of both methods rises with their individual classification accuracy. However, there are also a few examples, where this relationship does not hold true and the mutual information of EEG and NIRS classfier outputs is very small, as compared to their individual accuracies (see Fig. 8). To further examine these cases we offer an additional analysis, which is given in Fig. 9. As can be seen here the individual methods mostly misclassify different trials. In combination with the fact, that increased classification accuracy does arise by combining the classifier outputs meaningfully, we interpret these findings such that the individual methods complement each other in terms of information content.

In our study we validated the NIRS data as well as its combinations with EEG in an offline fashion, but our methods could also be applied to a real time experiment. In addition, a large number of potential extensions are possible in order to make the combined system faster to set-up. The current (wet) EEG channels could be replaced by dry electrodes (Popescu et al., 2007, Sellers et al., 2009, Grozea et al., 2011) and a zero-training classifier in the spirit of (Fazli et al., 2009a, Fazli et al., 2009b, Fazli et al., 2011) could be established for NIRS. A further interesting aspect would be to study non-stationarities during an experiment (Shenoy et al., 2006) and techniques for compensating it (Sugiyama et al., 2007, von Bünau et al., 2009) also for the present multi-modal BCI setup.

While in this contribution we focused on ERD-based BCIs, there is per se no reason why a NIRS–EEG combination would not also be beneficial for other BCI paradigms, such as event-related potential (ERP)-based BCIs or steady-state visual evoked potential (SSVEP)-based BCIs, among others. Future studies will show if these combinations will also yield beneficial results.

Acknowledgments
This work was supported by German Ministry for Research, Bernstein Focus Neurotechnology Berlin (01GQ0850) and in part by NIH Grant nos. R42NS050007 and R44NS049734. We would like to thank Stefan Haufe for fruitful discussions, NIRx Medizintechnik GmbH (Berlin, Germany) for providing the near-infrared imaging system and Michaela Rausch for the help with the measurements.
